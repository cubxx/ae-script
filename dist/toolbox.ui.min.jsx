// Cubx https://github.com/Cubxx/ae-script 2024/7/31 15:26:38
(function(){var e=Array.prototype;var r=Object.prototype;var n=r.hasOwnProperty;var t=e.concat;var o=e.push;var a=e.slice;var u=r.toString;var i=9007199254740991;var c=/\w*$/;var l=/^(?:0|[1-9]\d*)$/;function f(e,r){return null!=e&&n.call(e,r)}function s(e){if(null==e)return!1;var r=typeof e;return"object"===r||"function"===r}function p(e,r){var n=Object(e);if(s(r))for(var t in r)if(f(r,t))n[t]=r[t];return n}function v(e,r){var n=-1;var t=e.length;for(;++n<t;)if(e[n]===r)return!0;return!1}function d(e){if(null==e)return void 0===e?"[object Undefined]":"[object Null]";else return u.call(e)}function y(e){return"[object Array]"==d(e)}function h(e){return function(e){return"object"==typeof e&&null!==e}(e)&&"[object Arguments]"==d(e)}function m(){var e=-1;var r=arguments.length;for(;++e<r;)if(arguments[e])return!0;return!1}function g(){return!1}function _(e,r){var n=-1;var t=null==e?0:e.length;var o=new Array(t);for(;++n<t;)o[n]=r(e[n],n,e);return o}function b(e,r){return!!(r=null==r?i:r)&&m("number"===typeof e,l.test(e))&&e>-1&&e%1==0&&e<r}function w(e){return null!=e&&"function"!=typeof e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)}function A(e){if(null==e)return[];if(w(e))return function(e,r){var n=y(e);var t=!n&&h(e);var o=n||t;var a=e.length;var u=new Array(o?a:0);var i=o?-1:a;for(;++i<a;)u[i]="".concat(i);for(var c in e)if(f(e,c)&&(!o||"length"!==c&&!b(c,a)))u.push(c);return u}(e);var r=[];for(var n in e)if(f(e,n))r.push(n);return r}function x(e){return y(e)||h(e)}function P(e,r){var n=-1;var t=0;var o=null==e?0:e.length;var a=[];for(;++n<o;){var u=e[n];if(r(u,n,e))a[t++]=u}return a}var j="[object Arguments]";var E="[object Boolean]";var B="[object Date]";var k="[object Number]";var D="[object Object]";var S="[object RegExp]";var C="[object String]";var L={};L[j]=L["[object Array]"]=L[E]=L[B]=L[k]=L[D]=L[S]=L[C]=!0;L["[object Error]"]=!1;function G(e,r){var n=e.constructor;switch(r){case E:case B:return new n(e.valueOf());case k:case C:return new n(e);case S:return function(e){var r=c.exec(e.toString());var n=null===r?void 0:r.toString();var t=new(0,e.constructor)(e.source,n);t.lastIndex=e.lastIndex;return t}(e)}}function I(e){var r=e.length;var n=new(0,e.constructor)(r);if(r&&function(e){return"string"==typeof e[0]&&f(e,"index")}(e)){n.index=e.index;n.input=e.input}return n}function V(e,r,n,t,o,a,u){var i;if(void 0!==i)return i;if(!s(e))return e;var c=y(e);var l=d(e);if(c)return function(e,r){var n=-1;var t=e.length;r||(r=new Array(t));for(;++n<t;)r[n]=e[n];return r}(e,i=I(e));else{var f="function"==typeof e;if(m(l==D,l==j,f&&!o)){i=f?{}:function(e){var r=e.constructor;return"function"==typeof r&&r instanceof r?new r:{}}(e);return function(e,r,n){n||(n={});var t=-1,o=r.length;for(;++t<o;){var a=r[t];n[a]=e[a]}return n}(e,A(e),i)}else return L[l]?G(e,l):o?e:{}}}function N(e,r){var n=-1;var t=e.length;for(;++n<t&&!1!==r(e[n],n,e););return e}function R(e){return e!=e}function T(e,r){return!!(null==e?0:e.length)&&function(e,r,n){return r==r?function(e,r,n){var t=n-1;var o=e.length;for(;++t<o;)if(e[t]===r)return t;return-1}(e,r,n):function(e,r,n,t){var o=e.length;var a=n+-1;for(;++a<o;)if(r(e[a],a,e))return a;return-1}(e,R,n)}(e,r,0)>-1}function M(e,r){var n=-1;var t=e.length;for(;++n<t;)if(r(e[n],n,e))return!0;return!1}function O(e,r){return function(e,r,n,t,a){n||(n=x);a||(a=[]);if(null==e)return a;var u=-1,i=e.length;for(;++u<i;){var c=e[u];if(n(c))o.apply(a,c);else a[a.length]=c}return a}(_(e,r))}function U(e,r){for(var n in e)if(f(e,n))if(!1===r(e[n],n,e))break;return e}function z(e){return null==e}function W(e){return null!=e&&e.length?function(e,r,n){var t=-1;var o=T;var a=[];var u=a;var i=e.length;u=a;e:for(;++t<i;){var c=e[t];var l=c;c=0!==c?c:0;if(l==l){var f=u.length;for(;f--;)if(u[f]===l)continue e;a.push(c)}else if(!o(u,l)){if(u!==a)u.push(l);a.push(c)}}return a}(e):[]}function F(e){return function(r){return null!=r&&r instanceof e}}var K=F(Panel);var Q=F(Window);var X=this;var H=$.global;var J={version:"beta 1.0.0",parse:function(e){r=[Window,Panel,Group],N(r,(function(e){var r=e.prototype;r.getElementById=Pe;r.getElementsByName=Ee;r.getElementsByType=Be;xe(r,"getElementById");xe(r,"getElementsByName");xe(r,"getElementsByType")}));var r;var n=s(e)?e:{};var t=ge.apply(null,function(e,r){var n=p((t=Z,V(t)),function(e){return pe(e,"config")}(e));var t;var o=Boolean(n.show);var a=Boolean(n.dockable);var u=Boolean(n.singleton);var i=function(e,r,n){if(n||!r)return Window;if(Se(X))return X;return Se(e)?e:Window}(r.context,a,u);var c=function(e,r){if(v(Y,r))return r;if(v(Y,e))return e;return 0}(r.layoutMode,n.layoutMode);return[u,e,i,o,c]}(n,J));J.windows.push(t);return t},windows:[]};var Y=[0,1,2];var q=["dialog","palette","window"];var Z={dockable:!0,show:!0,singleton:!1};var ee={button:3,checkbox:3,dropdownlist:3,edittext:3,iconbutton:3,image:3,listbox:3,progressbar:4,radiobutton:3,scrollbar:5,slider:5,statictext:3,treeview:3};var re={group:2,panel:3,tab:3,tabbedpanel:3};var ne={button:"A",checkbox:"B",dialog:"C",dropdownlist:"D",edittext:"E",group:"G",iconbutton:"H",image:"I",item:"J",listbox:"K",node:"L",palette:"M",panel:"N",progressbar:"O",radiobutton:"P",scrollbar:"Q",slider:"R",statictext:"S",tab:"T",tabbedpanel:"U",treeview:"V",window:"W"};var te=/[CGMNTW][ABDEFGHIKNOPQRSUV]|[DK]J|[VL][LJ]|UT/;var oe=be(/[DGKLNTUV]/),ae=be(/[DKLV]/),ue=be(/[GNTU]/),ie=be(/[ABDEHIKOPQRSV]/),ce=be(/[DKUV]/);function le(e,r,n,t){return"node"==n?function(e,r,n,t){var o=je(r);var a=function(e,r){return e.add("node",r)}(e,ke(r));if(o.expanded)t.nodeItems.push(a);delete o["expanded"];p(a,o);return a}(e,r,0,t):function(e,r,n,t){var o=je(r);var a=function(e,r,n){return e.add(r,n[1],n[2],n[3])}(e,n,se(r,n));if(ce(n)&&f(o,"selection")){var u={container:a,itemIndex:o.selection};t.selectableElement.push(u);delete o["selection"];return p(a,o)}p(a,o);return a}(e,r,n,t)}function fe(e,r,n,t){var o=ae(e.type)?function(e,r,n,t){return o=e,a=ke(r),o.add("item",a);var o,a}(e,r):function(e,r,n,t){return function(e,r,n){return e.add(r,n[1],n[2],n[3],n[4],n[5])}(e,n,se(r,n))}(e,r,n);p(o,je(r))}function se(e,r){return function(e,r){var n=e[0];if(z(n))return e;var t=function(e){if(ie(e))return ee[e];if(ue(e))return re[e];return 0}(r);var o=e[t];if(!s(o))e[t]={};if(f(o,"name"))return e;e[t].name=n;return e}(function(e){return y(e)?Ce(e):de(e)}(e),r)}function pe(e,r){return z(e)?void 0:e[r]}function ve(e){var r=e.properties;return r&&r.name}function de(e){var r=pe(e,"param");return y(r)?Ce(r):[]}function ye(e){var r=pe(e,"style");return s(r)?r:{}}function he(e,r,n,t){var o=_e(e,r);De(o,t);if(Q(o)&&n)o.show();return o}function me(e,r,n,t){var o;return function(){if(function(e){return z(e)||!e.visible}(o))o=_e(e,r);De(o,t);if(Q(o)&&n)o.show();return o}}function ge(e){return(e?me:he).apply(null,a.call(arguments,1))}function _e(e,r){var n=function(e,r){var n=function(e,r){return K(r)?r:new Window(e[0],e[1],e[2],e[3])}(function(e){var r=String(e[0]);e[0]=v(q,r)?r:["palette"];return e}(de(e)),r);n.onResizing=n.onResize=function(){this.layout.resize()};p(n,ye(e));return n}(e,r);var t={nodeItems:[],selectableElement:[]};Le(e,n,t);N(t.selectableElement,(function(e){var r=e.container;var n=e.itemIndex;if("tabbedpanel"==r.type)r.selection=n;else r.selection=_(function(e){return y(e)?e:[e]}(n),(function(e){return r.items[e]}))}));N(t.nodeItems,(function(e){e.expanded=!0}));return n}function be(e){return function(r){if(f(ne,r))return e.test(ne[r]);else return!1}}function we(e,r,n,t){return M(e,(function(e){var o=[];return M(e.children,(function(e){if(ue(e.type))o.push(e);if(t(e))r.push(e);return n(r)}))?!0:we(o,r,n,t)}))}function Ae(e){return W(_(t.apply([],e),String))}function xe(e,r){e.watch(r,(function(e,r){return r}))}function Pe(e){var r=String(e);var n=[];we([this],n,(function(e){return e.length>0}),(function(e){var n=ve(e);if(z(n))return!1;else return r===n}));return 0===n.length?null:n[0]}function je(e){return y(e)?{}:ye(e)}function Ee(){var e=Ae(arguments);var r=[];var n=[];we([this],n,(function(){return e.length===r.length}),(function(n){var t=ve(n);if(z(t))return!1;if(v(e,t)&&!v(r,t)){r.push(t);return!0}return!1}));return 0===n.length?null:n}function Be(){var e=Ae(arguments);var r=[];we([this],r,g,(function(r){return v(e,r.type)}));return 0===r.length?null:r}function ke(e){var r=s(e)?function(e){return pe(e,"param")}(e):e;return String(r)}function De(e,r){e.layout.layout(r);e.layout.resize()}function Se(e){return e===H||K(e)}function Ce(e){return _(e,(function(e){return function(e){return null===e}(e)?void 0:e}))}function Le(e,r,n){U(e,(function(e,t){var o=(a=t,a.replace(/\d/g,"")).toLowerCase();var a;if(function(e){return f(ne,e)}(o)&&(u=r.type,i=o,c=ne[u]+ne[i],te.test(c)))if(oe(o)){Le(e,le(r,e,o,n),n)}else fe(r,e,o);var u,i,c}))}function Ge(e,r){var n=0;var t=e.numProperties+1;for(;++n<t&&!1!==r(e.property(n),n,e););return e}var Ie={abort:function(e){if(!$.level)alert(e,"Abort");throw new Error(e)},checkLength:function(e,r,n){if(void 0===n)n=1;if(e.length<n)Ie.abort(r)},emptyArray:function(e){var r={};var n=P(_(e,(function(e,n){if(e instanceof PropertyGroup){return{parentProperty:e.parentProperty,propertyIndex:e.propertyIndex}}else r[n]=e})),(function(e){return!!e}));_(n,(function(e){(0,e.parentProperty)(e.propertyIndex).remove()}));U(r,(function(e){return e.remove()}))}};var Ve={get_active_comp:function(){var e=app.project.activeItem;return e instanceof CompItem?e:Ie.abort("Please select a comp")},get_selected_comps:function(){var e=P(app.project.selection,(function(e){return e instanceof CompItem}));Ie.checkLength(e,"Please select comps in project panel");return e},get_selected_layers:function(){var e=Ve.get_active_comp().selectedLayers;Ie.checkLength(e,"Please select layers");return e},get_selected_properties:function(){return O(Ve.get_selected_layers(),(function(e){return e.selectedProperties}))},add_layer:function(e){var r,n;if(void 0===e)e="Shape";return null===(n=(r=this.get_active_comp().layers)["add"+e])||void 0===n?void 0:n.call(r)},add_solid_layer:function(e){if(void 0===e)e=[.5,.5,.5,1];var r=Ve.add_layer();r.name="Solid";var n=r.property("ADBE Root Vectors Group");n.addProperty("ADBE Vector Shape - Rect").property("Size").setValue([r.width,r.height]);n.addProperty("ADBE Vector Graphic - Fill").property("Color").setValue(e);return r},add_adjustment_layer:function(){var e=Ve.add_solid_layer();e.name="Adjustment";e.label=5;e.adjustmentLayer=!0;return e},add_null_layer:function(){var e=Ve.add_layer();e.name="Null";e.label=1;e.transform.scale.expression=" 100";e.transform.opacity.setValue(0);e.property("ADBE Root Vectors Group").addProperty("ADBE Vector Shape - Rect");return e},add_layer_from_group:function(e){var r=e.propertyGroup(2);if(!(r instanceof ShapeLayer))return Ie.abort("Please select ShapeLayer > Contents > Group");var n=r.duplicate();n.name=[r.name,e.name].join(" - ");var t=n.property("ADBE Root Vectors Group");var o=[];Ge(t,(function(r,n){n+1!=e.propertyIndex&&r&&o.push(r)}));Ie.emptyArray(o);return n},add_layers_from_selected_groups:function(){var e=P(Ve.get_selected_properties(),(function(e){return e instanceof PropertyGroup&&!(e instanceof MaskPropertyGroup)}));Ie.checkLength(e,"Please select PropertyGroups, MaskPropertyGroup is not allowed");var r=_(e,(function(e){return Ve.add_layer_from_group(e),e}));Ie.emptyArray(r)},unpack_comp:function(e){e.selected=!0;var r=e.containingComp,n=e.startTime;var t=e.source.layers;for(var o=1;o<=t.length;o++){t[o].copyToComp(r);r.layers[e.index-1].startTime+=n}e.selected=!1},unpack_selected_comps:function(){var e=P(Ve.get_selected_layers(),(function(e){e.selected=!1;return e instanceof AVLayer&&e.source instanceof CompItem}));Ie.checkLength(e,"Please select Comp layers");var r=_(e,(function(e,r){return Ve.unpack_comp(e),e.source}));Ie.emptyArray(r)},unpack_layer:function(e){e.selected=!0;var r=e.property("ADBE Root Vectors Group");var n=[];Ge(r,(function(e){e instanceof PropertyGroup&&!(e instanceof MaskPropertyGroup)&&n.push(e)}));Ie.checkLength(n,"".concat(e.name," layer only has ").concat(n.length," Groups"),2);_(n,Ve.add_layer_from_group);e.selected=!1},unpack_selected_layers:function(){var e=P(Ve.get_selected_layers(),(function(e){e.selected=!1;return e instanceof ShapeLayer}));Ie.checkLength(e,"Please select ShapeLayers");var r=_(e,(function(e){return Ve.unpack_layer(e),e}));Ie.emptyArray(r)},render:function(){app.project.renderQueue.showWindow(!0);app.project.renderQueue.render()},render_active_comp:function(){Ve.render_comp(Ve.get_active_comp())},render_selected_comps:function(){_(Ve.get_selected_comps(),Ve.render_comp)},render_comp:function(e){var r=app.project.renderQueue.items.add(e);Ve.render_setting(r);r.render=!0},render_setting:function(e){if(!app.project.file)return alert("Please save the project first");e.outputModule(1).setSettings({"Output File Info":{"Base Path":app.project.file.fsName.replace(/\\[^\\]+$/,""),"Subfolder Path":"render","File Name":e.comp.name}})},show_matchname:function(){var e=[];for(var r=0,n=[function(){return Ve.get_selected_properties()},function(){return Ve.get_selected_layers()}];r<n.length;r++){if((e=(0,n[r])()).length)break}var t=_(e,(function(e){return e.matchName}));prompt("You can copy them",t.join("; "),"MatchNames")},simple_fix_expression:function(){U({"3D Point":"ADBE Point3D Control",Angle:"ADBE Angle Control",Checkbox:"ADBE Checkbox Control",Color:"ADBE Color Control",Layer:"ADBE Layer Control",Point:"ADBE Point Control",Slider:"ADBE Slider Control","Dropdown Menu":"Pseudo/@@ABzbw5g3TlyO2XPLzAXD9w",Menu:"Pseudo/@@ABzbw5g3TlyO2XPLzAXD9w"},(function(e,r){app.project.autoFixExpressions("".concat(r," Control"),e);app.project.autoFixExpressions(r,"".concat(e,"-0001"))}))}};var Ne=function(e,r,n){var t=e.length;if(0!==t||void 0!==n){var o=void 0===n?e[0]:n;var a=void 0===n?0:-1;for(;++a<t;)o=r(o,e[a],a,e);return o}}([["UC","unpack_selected_comps"],["UL","unpack_selected_layers"],["AS","add_solid_layer"],["AA","add_adjustment_layer"],["AN","add_null_layer"],["AG","add_layers_from_selected_groups"],["R","render_selected_comps"],["F","simple_fix_expression"],["SM","show_matchname"]],(function(e,r,n){var t=r[0],o=r[1];e["button"+n]={style:{text:t,helpTip:o,preferredSize:[30,30],onClick:function(){return function(e,r){app.beginUndoGroup(e);r();app.endUndoGroup()}(t,Ve[o])}}};return e}),{style:{orientation:"column",alignChildren:"center",margins:0,spacing:0}});J.context=this;J.parse(Ne)}).call(this);
